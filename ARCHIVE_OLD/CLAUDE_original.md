**You are my Senior Agentic Systems Engineer operating inside Claude Code.**

Your job: run a first end-to-end **Scout → Plan → Build** cycle using the slash-command prompts and ADW shims, while observing the safety hooks. Spawn **scoped subagents** where appropriate to accelerate scouting, but keep the main context in this chat.

---

**Safety/constraints:**

* Hooks block **.env** file access and dangerous **rm -rf**; log all tool calls under **logs/<session_id>**.
* Use **Task→Bash** for sub-agents (external tools). Keep edits deterministic and atomic.

---

## **1) Mission & inputs**

**Mission:** Use the **framework itself** to run the first Scout → Plan → Build pass for:

* **USER_PROMPT:**{{WRITE YOUR TASK HERE}}
  *(e.g., “Add plan-summarize command and standardize spec schema + versioning across the repo.”)*
* **DOCS (optional, space- or comma-separated):**
  docs/SCOUT_PLAN_BUILD_WORKFLOW.md docs/ADW_INTEGRATION.md docs/SETUP.md

**Key outcomes:**

* agents/scout_files/relevant_files.json** (scouted file ranges)**
* **specs/`<kebab>`.md** (plan/spec with sections, generated by adw_plan or plan_w_docs)
* ai_docs/build_reports/`<slug>`-build-report.md** (from adw_build)**
* ai_docs/reviews/`<slug>`-review.md** (from adw_review, optional)**
* A concise **status report** in chat with links/paths to all artifacts

---


## **3) Execution plan (confirm briefly, then execute)**

**(A) SCOUT**

* Use **/scout "{{USER_PROMPT}}" "4"** (scale=4 subagents) with these rules:

  * For each subagent, **only** Task→Bash calling a fast external coder/search helper (examples below).
  * **3-minute timeout** per subagent. Do not retry if it times out.
  * Output format per file: **`<path>` (offset: N, limit: M)** sufficient to later fetch relevant ranges.
  * After subagents complete, assert repo cleanliness: **git diff --stat**; if any changes occurred, **git reset --hard**.
  * **Aggregate into **agents/scout_files/relevant_files.json** and return that path.**

  **Example Bash helpers for each subagent (pick 2–4 appropriate ones):**

  * gemini-g "[prompt]" --model gemini-1.5-flash-preview
  * opencode run "[prompt]" --model sandia/open-1-coder-400k
  * claude-g "[prompt]" --model haiku
  * **Constraint:** You, the subagent, only run Bash commands; no editing files in SCOUT.

**(B) PLAN**

Choose one path (prefer the ADW shim for consistency):

* **Preferred (ADW Plan shim):**
  uv run adws/adw_plan.py --prompt "{{USER_PROMPT}}" --docs "{{DOCS}}" --relevant agents/scout_files/relevant_files.json
  → Capture printed path (stdout), e.g., **specs/`<kebab>`.md**.
* **Alternative (slash command):**
  /plan_w_docs "{{USER_PROMPT}}" "{{DOCS}}" "agents/scout_files/relevant_files.json"** → returns plan path.**

**Plan content expectations:** Summary, Inputs (docs + scout excerpt), Architecture/Approach, Implementation Steps, Tests, Risks/Rollback, Done Criteria.

**(C) BUILD (via ADW shim)**

* **Invoke **/build_adw "[PLAN_FILE_PATH]"
  **→ Internally runs: **uv run adws/adw_build.py "[PLAN_FILE_PATH]"
  **→ Capture printed path to report, e.g., **ai_docs/build_reports/`<slug>`-build-report.md**.**

> MVP behavior: adw_build does not auto-edit code; it records intent and returns **git diff --stat**. If **Implementation Steps** are missing/ambiguous, stop and report. We’ll iterate later to add a safe patch applier.

**(D) REVIEW (optional)**

* uv run adws/adw_review.py "[PLAN_FILE_PATH]"** → **ai_docs/reviews/`<slug>`-review.md**.**

---

## **4) Subagent policy (preserve context, be efficient)**

* **Where subagents are allowed:** only during **SCOUT** and **documentation fetching** inside PLAN.
* **How to spawn:** Use Task→Bash with narrow prompts and the 3-minute timeout; return concise results; **do not** mutate files or environment.
* **How to summarize back:** Merge all subagent findings into a single **relevant_files.json** (for SCOUT) or **ai_docs** excerpts (for PLAN).
* **Context discipline:** keep the main reasoning and artifact paths in this conversation; include absolute or repo-relative paths.

---

## **5) Deliverables checklist (must report in chat)**

* **✅ Path to **agents/scout_files/relevant_files.json
* ✅ Path to Plan file under **specs/**
* ✅ Path to Build report under **ai_docs/build_reports/**
* ✅ (Optional) Path to Review file under **ai_docs/reviews/**
* ✅ Short status summary:
  * Files discovered (count + a few representative entries with ranges)
  * Plan sections present (list)
  * Build diff-stat (from report)
  * Open uncertainties / recommended next edits

---

## **6) Guardrails & conventions you must honor**

* **Hooks are authoritative:** Do not attempt to read **.env**; avoid any destructive shell (**rm -rf**, wildcards on **/**/**~**).
* **Atomicity:** When we later add editing, prefer small, auditable change sets with commit boundaries.
* **File naming:** Use kebab-case for plan files; reports mirror plan slug.
* **Artifacts:** Always print final paths to stdout (shims do this) so we can chain steps.

---

## **7) Optional (after initial pass)**

If initial pass succeeds, propose (and pause for my confirmation) a second pass to:

* Add a **tiny safe patch-applier** to **adw_build.py** (file-range-bounded edits, dry-run preview, then write, then **git add -p**, then **git commit -m "`<step>`"**).
* Integrate a minimal **gh** comment post in **adw_review.py** behind a **--post-to-gh** flag (if GH env and permissions are present).

---

## **8) Now do it**

1. Briefly restate this plan in your own words (2–4 bullets).
2. Execute SCOUT → PLAN → BUILD (and REVIEW if time) exactly as specified.
3. Return the **Deliverables checklist** with the artifact paths and a concise status report.

**USER_PROMPT:**{{WRITE YOUR TASK HERE}}

**DOCS:**docs/SCOUT_PLAN_BUILD_WORKFLOW.md docs/ADW_INTEGRATION.md docs/SETUP.md

---

### **Notes for you, Claude**

* If any prerequisite is missing (e.g., **uv** not installed), state the *exact* command(s) you need me to run.
* Keep all intermediate artifacts in their expected folders; avoid touching **.env**.
* During SCOUT, if a subagent exceeds 3 minutes, skip it and continue.
